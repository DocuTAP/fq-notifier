# FQ Notifier
A simple serverless app that converts a task posted to the Fireman Queue into a rich-text Slack message

### Setup
Step 0) Install the serverless node package.  I recommend having it globally available.
```sh
$ npm install --global serverless
```

With that, confirm you have AWS credentials setup and ready.  If you would like, you can setup a separate
profile so that you can keep your serverless administration separate from regular AWS.  Below steps
will assume you have an additional profile named `serverlessAdmin` setup in your AWS credentials.  To setup
another set of credentials, use the following command (which assumes you have the `awscli` installed, which
MacOS users can get from `brew`).
```sh
$ aws configure --profile [your-desired-profile-name]
```

Step 1) To deploy the function, run the following:
```sh
$ serverless deploy -v --aws-profile serverlessAdmin
```

Step 2) To take advantage of the functionality provided by this app, you'll need to create
a [Slack App](https://api.slack.com/apps).

Step 2a) After creating your Slack App, on the left hand menu under *Features*, select _Interactive Components_
and turn it on. For _Request URL_, put the endpoint generated by Step 1 and then Save Changes.

Step 2b) Again under *Features*, select _Bot User_ and Create a Bot User.  Name it whatever best suits your needs,
and make sure to always show your bot as Online.

Step 2c) Finally, under *Features* in _OAuth & Permissions_, you'll see two tokens already generated, named
"OAuth Access Token" and "Bot User OAuth Access Token".  Remember where the "Bot User OAuth Access Token" is
because you'll need it for the next step.

Step 3) After the function has finished, navigate to the AWS Lambda console, select your newly created
function and add the Environment Variables for the following:
- `CLOCKWISE_API_URL` => The API URL to Clockwise.MD
- `CLOCKWISE_API_KEY` => The API Access Key to interact with Clockwise.MD
- `SLACK_OAUTH_ACCESS` => The "Bot User OAuth Access Token" found by following instructions in Step 2c

and press Save.

And that's it!

### Changing
Assuming you've gone through the Setup steps, if you want to make any changes, you can run the following
to quickly push up your changes.
```sh
$ serverless deploy function -f app --aws-profile serverlessAdmin
```

